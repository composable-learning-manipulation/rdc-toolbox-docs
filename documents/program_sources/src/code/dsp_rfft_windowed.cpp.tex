\begin{lstlisting}[caption=\raggedright{mcu-libs/RLS.h}, frame=single]
#include <string.h>
#include "fpu.h"
#include "dsp.h"
#include "dsp_setup.h"
#include "fpu32/fpu_rfft.h"
#include "dsp_rfft_windowed.h"


//*****************************************************************************
// the globals
//*****************************************************************************

// Object of the structure RFFT_F32_STRUCT
RFFT_F32_STRUCT rfft;
// Handle to the RFFT_F32_STRUCT object
RFFT_F32_STRUCT_Handle hnd_rfft = &rfft;

// Object of the structure RFFT_ADC_F32_STRUCT
RFFT_ADC_F32_STRUCT rfft_adc;
// Handle to the RFFT_ADC_F32_STRUCT object
RFFT_ADC_F32_STRUCT_Handle hnd_rfft_adc = &rfft_adc;


float test_output[TEST_SIZE];
float test_magnitude_phase[(TEST_SIZE >> 1) + 1];
float twiddleFactors[TEST_SIZE];

volatile uint16_t flagInputReady = 0;

// Index into the FFT input buffer
volatile uint16_t sampleIndex = 0;



void FFT_torque_disturbance_init(void)
{
    // Configure the object
        RFFT_f32_setInputPtr(hnd_rfft, (float *)test_input);
        RFFT_f32_setOutputPtr(hnd_rfft, test_output);
        RFFT_f32_setMagnitudePtr(hnd_rfft, test_magnitude_phase);
        RFFT_f32_setPhasePtr(hnd_rfft, test_magnitude_phase);
        RFFT_f32_setStages(hnd_rfft,  FFT_STAGES);
        RFFT_f32_setFFTSize(hnd_rfft, FFT_SIZE);

        // Twiddle factor pointer
    #ifdef USE_TABLES
        RFFT_f32_setTwiddlesPtr(hnd_rfft, RFFT_f32_twiddleFactors);
    #else
        //Calculate twiddle factor
        RFFT_f32_setTwiddlesPtr(hnd_rfft, twiddleFactors);
        RFFT_f32_sincostable(hnd_rfft);
    #endif //USE_TABLES

        //Link the RFFT_ADC_F32_STRUCT to RFFT_F32_STRUCT. Tail pointer
        //of RFFT_ADC_F32_STRUCT must point to the OutBuf pointer of
        //RFFT_F32_STRUCT
        RFFT_ADC_f32_setTailPtr(hnd_rfft_adc, &(hnd_rfft->OutBuf));
        RFFT_ADC_f32_setInBufPtr(hnd_rfft_adc, test_input);
}

\end{lstlisting}
